# Position Analysis ä½¿ç”¨åœºæ™¯æŒ‡å—

> ğŸ“– æ ¹æ®ä½ çš„åˆ†æéœ€æ±‚,å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„ç­–ç•¥å’Œå·¥å…·
> ğŸ¯ å®æˆ˜å¯¼å‘,åœºæ™¯åŒ–è¯´æ˜

---

## ğŸ¯ å¿«é€Ÿå¯¼èˆª

| ä½ æƒ³åˆ†æä»€ä¹ˆ? | è·³è½¬åˆ° |
|-------------|--------|
| æŠ€æœ¯é¢(MACD/KDJ/RSIç­‰) | [åœºæ™¯1: æŠ€æœ¯é¢åˆ†æ](#åœºæ™¯1-æŠ€æœ¯é¢åˆ†æ) |
| èµ„é‡‘é¢(åŒ—å‘/å—å‘/èèµ„èåˆ¸) | [åœºæ™¯2: èµ„é‡‘é¢åˆ†æ](#åœºæ™¯2-èµ„é‡‘é¢åˆ†æ) |
| ä¼°å€¼(PE/PBè´µä¸è´µ) | [åœºæ™¯3: ä¼°å€¼åˆ†æ](#åœºæ™¯3-ä¼°å€¼åˆ†æ) |
| æƒ…ç»ª(å¸‚åœºç«ä¸ç«) | [åœºæ™¯4: å¸‚åœºæƒ…ç»ªåˆ†æ](#åœºæ™¯4-å¸‚åœºæƒ…ç»ªåˆ†æ) |
| é£é™©(ä¼šä¸ä¼šè§é¡¶) | [åœºæ™¯5: é£é™©æ£€æµ‹](#åœºæ™¯5-é£é™©æ£€æµ‹) |
| å†å²ç›¸ä¼¼ç‚¹ä½ | [åœºæ™¯6: å†å²ç‚¹ä½å¯¹æ¯”](#åœºæ™¯6-å†å²ç‚¹ä½å¯¹æ¯”) |
| ç»¼åˆåˆ¤æ–­(æ‰€æœ‰ç»´åº¦) | [åœºæ™¯7: ç»¼åˆåˆ†æ](#åœºæ™¯7-ç»¼åˆåˆ†æ-æ¨è) |

---

## åœºæ™¯1: æŠ€æœ¯é¢åˆ†æ

### ğŸ“Œ **ä½ æƒ³çŸ¥é“**:
- MACDæ˜¯é‡‘å‰è¿˜æ˜¯æ­»å‰?
- RSIæ˜¯è¶…ä¹°è¿˜æ˜¯è¶…å–?
- KDJä¿¡å·æ€ä¹ˆæ ·?
- å‡çº¿æ˜¯å¤šå¤´è¿˜æ˜¯ç©ºå¤´æ’åˆ—?
- æœ‰æ²¡æœ‰æŠ€æœ¯èƒŒç¦»?

### ğŸ”§ **ä½¿ç”¨å·¥å…·**:

#### **æ–¹æ³•1: ä½¿ç”¨èƒŒç¦»åˆ†æå™¨(æ¨è)**
```python
from position_analysis.analyzers.technical_analysis.divergence_analyzer import DivergenceAnalyzer, normalize_dataframe_columns
from position_analysis.core.historical_position_analyzer import HistoricalPositionAnalyzer

# è·å–æ•°æ®
analyzer = HistoricalPositionAnalyzer()
df = analyzer.get_index_data('sz399006')  # åˆ›ä¸šæ¿æŒ‡
df = normalize_dataframe_columns(df)

# æŠ€æœ¯èƒŒç¦»åˆ†æ
div_analyzer = DivergenceAnalyzer(lookback_period=60)
result = div_analyzer.comprehensive_analysis(df, symbol='åˆ›ä¸šæ¿æŒ‡', market='CN')

# æŸ¥çœ‹ç»“æœ
if result['has_any_divergence']:
    for signal in result['summary']:
        print(f"{signal['type']} - {signal['direction']}")
        print(f"å¼ºåº¦: {signal['strength']}/100")
        print(f"æè¿°: {signal['description']}")
```

#### **æ–¹æ³•2: ä½¿ç”¨å¸‚åœºåˆ†æå™¨(ä¸€ç«™å¼)**
```bash
# Aè‚¡æŠ€æœ¯é¢åˆ†æ
python -c "
from position_analysis.market_analyzers.cn_market_analyzer import CNMarketAnalyzer
analyzer = CNMarketAnalyzer()
result = analyzer.analyze_single_index('sz399006', tolerance=0.05)
print('æŠ€æœ¯èƒŒç¦»:', result.get('technical_divergence', 'æ— '))
"
```

### ğŸ“Š **æŸ¥çœ‹å“ªäº›æŒ‡æ ‡**:
| æŒ‡æ ‡ | ä½ç½® | å«ä¹‰ |
|------|------|------|
| MACDèƒŒç¦» | `result['details']['macd']` | é¡¶èƒŒç¦»â†’è§é¡¶ / åº•èƒŒç¦»â†’è§åº• |
| RSIèƒŒç¦» | `result['details']['rsi']` | ä»·æ ¼æ–°é«˜ä½†RSIä¸åˆ›æ–°é«˜â†’åŠ¨èƒ½è¡°ç«­ |
| é‡ä»·èƒŒç¦» | `result['details']['volume_price']` | ä»·æ ¼æ¶¨ä½†é‡ç¼©â†’ä¸Šæ¶¨ä¹åŠ› |

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: åˆ›ä¸šæ¿æŒ‡æ•°MACDå‡ºç°é¡¶èƒŒç¦»äº†å—?
æ“ä½œ: è¿è¡Œä¸Šé¢ä»£ç 
ç»“æœ:
  - æœ‰èƒŒç¦» â†’ "MACDé¡¶èƒŒé©°,å¼ºåº¦90/100,é«˜ç½®ä¿¡åº¦"
  - æ— èƒŒç¦» â†’ "æš‚æ— èƒŒç¦»ä¿¡å·,ä»·æ ¼ä¸æŠ€æœ¯æŒ‡æ ‡é…åˆè‰¯å¥½"

åˆ¤æ–­:
  - MACDé¡¶èƒŒç¦» â†’ ä¸Šæ¶¨åŠ¨èƒ½è¡°ç«­,å»ºè®®å‡ä»“
  - æ— èƒŒç¦» â†’ æŠ€æœ¯é¢å¥åº·,å¯ç»§ç»­æŒæœ‰
```

---

## åœºæ™¯2: èµ„é‡‘é¢åˆ†æ

### ğŸ“Œ **ä½ æƒ³çŸ¥é“**:
- **Aè‚¡**: åŒ—å‘èµ„é‡‘åœ¨ä¹°è¿˜æ˜¯å–?
- **Aè‚¡**: èèµ„èµ„é‡‘æ˜¯æµå…¥è¿˜æ˜¯æµå‡º?
- **æ¸¯è‚¡**: å—å‘èµ„é‡‘(å†…åœ°èµ„é‡‘)åœ¨ä¹°æ¸¯è‚¡å—?
- ä¸»åŠ›èµ„é‡‘åœ¨è¿›è¿˜æ˜¯å‡º?

### ğŸ”§ **ä½¿ç”¨å·¥å…·**:

#### **Aè‚¡ - åŒ—å‘èµ„é‡‘**
```python
from position_analysis.analyzers.market_specific.cn_stock_indicators import CNStockIndicators

cn_indicators = CNStockIndicators()

# åŒ—å‘èµ„é‡‘
north_flow = cn_indicators.get_north_flow()
print(f"ä»Šæ—¥åŒ—å‘èµ„é‡‘: {north_flow['today_flow']:.2f}äº¿")
print(f"è¿‘5æ—¥ç´¯è®¡: {north_flow['recent_5d_flow']:.2f}äº¿")
print(f"çŠ¶æ€: {north_flow['status']}")  # æŒç»­æµå…¥/æµå‡º/éœ‡è¡
```

**åˆ¤æ–­é€»è¾‘**:
```
åŒ—å‘èµ„é‡‘è¿ç»­5æ—¥å‡€æµå…¥ > 50äº¿ â†’ å¤–èµ„çœ‹å¥½,ä¸­æœŸçœ‹å¤š
åŒ—å‘èµ„é‡‘è¿ç»­5æ—¥å‡€æµå‡º > 50äº¿ â†’ å¤–èµ„æ’¤é€€,éœ€è¦è­¦æƒ•
å•æ—¥æµå…¥ > 100äº¿ â†’ å¼ºçƒˆçœ‹å¤šä¿¡å·
å•æ—¥æµå‡º > 100äº¿ â†’ å¼ºçƒˆçœ‹ç©ºä¿¡å·
```

#### **Aè‚¡ - èèµ„èåˆ¸**
```python
from position_analysis.analyzers.market_specific.margin_trading_analyzer import MarginTradingAnalyzer

margin_analyzer = MarginTradingAnalyzer()

# èèµ„èåˆ¸æ•°æ®
margin_data = margin_analyzer.get_margin_data('sh000001')  # ä¸Šè¯æŒ‡æ•°
print(f"èèµ„ä½™é¢: {margin_data['margin_balance']:.2f}äº¿")
print(f"èèµ„ä¹°å…¥é¢: {margin_data['margin_buy']:.2f}äº¿")
print(f"è¶‹åŠ¿: {margin_data['trend']}")  # ä¸Šå‡/ä¸‹é™
```

**åˆ¤æ–­é€»è¾‘**:
```
èèµ„ä½™é¢å¿«é€Ÿä¸Šå‡(å•å‘¨+5%) â†’ æ•£æˆ·åŠ æ æ†,æƒ…ç»ªäº¢å¥‹,è­¦æƒ•è¿‡çƒ­
èèµ„ä½™é¢æŒç»­ä¸‹é™ â†’ æ æ†èµ„é‡‘æ’¤é€€,å¸‚åœºè½¬å†·
èèµ„ä¹°å…¥å æ¯” > 10% â†’ æ æ†ç‡é«˜,é£é™©å¤§
```

#### **æ¸¯è‚¡ - å—å‘èµ„é‡‘**
```python
from position_analysis.analyzers.market_specific.southbound_funds_analyzer import SouthboundFundsAnalyzer

sb_analyzer = SouthboundFundsAnalyzer()

# å—å‘èµ„é‡‘æµå‘
sb_flow = sb_analyzer.analyze_southbound_funds()
print(f"è¿‘5æ—¥æµå‘: {sb_flow['recent_5d_flow']:.2f}äº¿")
print(f"çŠ¶æ€: {sb_flow['status']}")
```

**åˆ¤æ–­é€»è¾‘**:
```
å—å‘èµ„é‡‘è¿ç»­æµå…¥ â†’ å†…åœ°èµ„é‡‘çœ‹å¥½æ¸¯è‚¡,æ¸¯è‚¡ä¸­æœŸçœ‹æ¶¨
å—å‘èµ„é‡‘è¿ç»­æµå‡º â†’ å†…åœ°èµ„é‡‘æ’¤ç¦»,æ¸¯è‚¡æ‰¿å‹
```

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: ç°åœ¨æ˜¯å¦é€‚åˆä¹°Aè‚¡?èµ„é‡‘é¢æ€ä¹ˆæ ·?
æ“ä½œ:
  1. æŸ¥åŒ—å‘èµ„é‡‘ â†’ è¿‘5æ—¥å‡€æµå…¥200äº¿
  2. æŸ¥èèµ„ä½™é¢ â†’ ç¨³å®šåœ¨1.8ä¸‡äº¿,æœªå¿«é€Ÿä¸Šå‡

åˆ¤æ–­:
  âœ… åŒ—å‘èµ„é‡‘å¤§å¹…æµå…¥ â†’ å¤–èµ„çœ‹å¥½
  âœ… èèµ„ä½™é¢ç¨³å®š â†’ æ²¡æœ‰è¿‡åº¦åŠ æ æ†
  â†’ èµ„é‡‘é¢æ”¯æŒ,å¯ä»¥ä¹°å…¥
```

---

## åœºæ™¯3: ä¼°å€¼åˆ†æ

### ğŸ“Œ **ä½ æƒ³çŸ¥é“**:
- ç°åœ¨Aè‚¡/æ¸¯è‚¡/ç¾è‚¡è´µä¸è´µ?
- PE/PBåœ¨å†å²ä»€ä¹ˆä½ç½®?
- æ˜¯é«˜ä¼°è¿˜æ˜¯ä½ä¼°?

### ğŸ”§ **ä½¿ç”¨å·¥å…·**:

#### **æ–¹æ³•1: ä½¿ç”¨ä¼°å€¼åˆ†æå™¨**
```python
from position_analysis.core.valuation_analyzer import ValuationAnalyzer

val_analyzer = ValuationAnalyzer()

# Aè‚¡ä¼°å€¼
valuation = val_analyzer.get_valuation_data('sh000001')  # ä¸Šè¯æŒ‡æ•°
print(f"PE: {valuation['pe']:.2f}")
print(f"PEåˆ†ä½æ•°: {valuation['pe_percentile']:.1f}%")
print(f"PB: {valuation['pb']:.2f}")
print(f"PBåˆ†ä½æ•°: {valuation['pb_percentile']:.1f}%")
print(f"ä¼°å€¼æ°´å¹³: {valuation['level']}")
```

#### **æ–¹æ³•2: ç”¨å¸‚åœºç»¼åˆåˆ†æå™¨(æ›´å¿«)**
```bash
# Aè‚¡ä¼°å€¼å¿«é€ŸæŸ¥çœ‹
python position_analysis/main.py  # é€‰æ‹©1(Aè‚¡)
# æŠ¥å‘Šä¸­ä¼šæ˜¾ç¤ºä¼°å€¼åˆ†ä½æ•°
```

### ğŸ“Š **ä¼°å€¼åˆ¤æ–­æ ‡å‡†**:

| PEåˆ†ä½æ•° | ä¼°å€¼æ°´å¹³ | æ“ä½œå»ºè®® |
|---------|---------|---------|
| < 20% | ä½ä¼° | âœ… ç§¯æä¹°å…¥åŒºåŸŸ |
| 20-40% | åˆç†åä½ | âœ… å¯ä»¥ä¹°å…¥ |
| 40-60% | åˆç† | âš–ï¸ æ­£å¸¸æŒæœ‰ |
| 60-80% | åˆç†åé«˜ | âš ï¸ è°¨æ…,é€¢é«˜å‡ä»“ |
| 80-90% | é«˜ä¼° | ğŸ”´ å»ºè®®å‡ä»“ |
| > 90% | ä¸¥é‡é«˜ä¼° | ğŸ”´ å¼ºçƒˆå»ºè®®å‡ä»“ |

**PBåˆ¤æ–­ç±»ä¼¼,ä½†æ›´ä¿å®ˆ**:
- PB < 1.0 â†’ ç ´å‡€,å¯èƒ½æ˜¯åº•éƒ¨åŒºåŸŸ(éœ€ç»“åˆè¡Œä¸š)

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: ä¸Šè¯æŒ‡æ•°ç°åœ¨3800ç‚¹,è´µä¸è´µ?èƒ½ä¹°å—?
æ“ä½œ: æŸ¥çœ‹ä¼°å€¼åˆ†ä½æ•°
ç»“æœ:
  PEåˆ†ä½æ•°: 78%
  PBåˆ†ä½æ•°: 75%

åˆ¤æ–­:
  âš ï¸ PE/PBéƒ½åœ¨70-80%åŒºé—´ â†’ åˆç†åé«˜
  â†’ ä¸æ˜¯æœ€ä½³ä¹°ç‚¹,ä½†ä¹Ÿä¸æ˜¯ç‰¹åˆ«è´µ
  â†’ å»ºè®®: è½»ä»“æˆ–ç­‰å›è°ƒ
```

---

## åœºæ™¯4: å¸‚åœºæƒ…ç»ªåˆ†æ

### ğŸ“Œ **ä½ æƒ³çŸ¥é“**:
- å¸‚åœºç°åœ¨ç«ä¸ç«?
- æ˜¯ç–¯ç‹‚è¿˜æ˜¯å†·æ¸…?
- æœ‰æ²¡æœ‰è¿‡çƒ­é£é™©?

### ğŸ”§ **ä½¿ç”¨å·¥å…·**:

```python
from position_analysis.analyzers.market_specific.cn_stock_indicators import CNStockIndicators

cn_indicators = CNStockIndicators()

# å¸‚åœºæƒ…ç»ªæ•°æ®
sentiment = cn_indicators.get_market_sentiment()
print(f"æ¶¨åœå®¶æ•°: {sentiment['limit_up_count']}åª")
print(f"è·Œåœå®¶æ•°: {sentiment['limit_down_count']}åª")
print(f"æ–°é«˜å®¶æ•°: {sentiment['new_high_count']}åª")
print(f"æƒ…ç»ªçŠ¶æ€: {sentiment['status']}")
```

### ğŸ“Š **æƒ…ç»ªåˆ¤æ–­æ ‡å‡†**:

| æ¶¨åœæ•° | å¸‚åœºçŠ¶æ€ | é£é™©æç¤º |
|-------|---------|---------|
| > 150åª/æ—¥ | ğŸ”¥ æƒ…ç»ªç™«ç‹‚ | ğŸ”´ æåº¦è¿‡çƒ­,é«˜é£é™© |
| 100-150åª | ğŸ“ˆ æƒ…ç»ªé«˜æ¶¨ | âš ï¸ è¿‡çƒ­,æ³¨æ„é£é™© |
| 50-100åª | ğŸ˜Š æƒ…ç»ªè‰¯å¥½ | âœ… å¥åº·ä¸Šæ¶¨ |
| 20-50åª | ğŸ˜ æƒ…ç»ªå¹³æ·¡ | âš–ï¸ æ­£å¸¸ |
| < 20åª | ğŸ˜” æƒ…ç»ªä½è¿· | âœ… å¯èƒ½æ˜¯æœºä¼š |

**ç‰¹æ®Šæƒ…å†µ**:
```
è·Œåœæ•° > 100åª/æ—¥ â†’ ææ…Œæ€§ä¸‹è·Œ,å¯èƒ½æ˜¯æŠ„åº•æœºä¼š
æ¶¨åœæ•° > 200åª + è·Œåœæ•° < 10åª â†’ å•è¾¹ä¸Šæ¶¨,æåº¦è¿‡çƒ­
```

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: æœ€è¿‘Aè‚¡æ¶¨å¾—å¾ˆçŒ›,è¿˜èƒ½è¿½å—?
æ“ä½œ: æŸ¥çœ‹å¸‚åœºæƒ…ç»ª
ç»“æœ:
  æ¶¨åœå®¶æ•°: 180åª/æ—¥
  è¿ç»­3å¤© > 150åª

åˆ¤æ–­:
  ğŸ”´ æƒ…ç»ªå·²ç»ç™«ç‹‚ â†’ æ•£æˆ·å…¨é¢å…¥åœº
  â†’ é€šå¸¸æ˜¯é˜¶æ®µæ€§é¡¶éƒ¨ä¿¡å·
  â†’ å»ºè®®: ä¸è¿½é«˜,é€¢é«˜å‡ä»“
```

---

## åœºæ™¯5: é£é™©æ£€æµ‹

### ğŸ“Œ **ä½ æƒ³çŸ¥é“**:
- ä¼šä¸ä¼šé©¬ä¸Šè§é¡¶?
- æœ‰æ²¡æœ‰æš´è·Œé£é™©?
- ä»€ä¹ˆæ—¶å€™è¯¥è·‘?

### ğŸ”§ **ä½¿ç”¨å·¥å…·**:

#### **Aè‚¡ç‰›å¸‚é¡¶éƒ¨æ£€æµ‹**
```python
from position_analysis.analyzers.risk_detection.bull_market_top_detector import BullMarketTopDetector

top_detector = BullMarketTopDetector()

# æ£€æµ‹è§é¡¶é£é™©
risk = top_detector.detect_top_risk()
print(f"ç»¼åˆé£é™©è¯„åˆ†: {risk['overall_risk']:.2f}")  # 0-1ä¹‹é—´
print(f"é£é™©ç­‰çº§: {risk['risk_level']}")  # ä½/ä¸­/é«˜/æé«˜
print(f"é£é™©å› ç´ :")
for factor in risk['risk_factors']:
    print(f"  - {factor}")
```

#### **ç¾è‚¡è§é¡¶æ£€æµ‹**
```python
from position_analysis.analyzers.risk_detection.us_market_top_detector import USMarketTopDetector

us_top = USMarketTopDetector()
us_risk = us_top.detect_top_risk()
print(f"ç¾è‚¡è§é¡¶é£é™©: {us_risk['overall_risk']:.2f}")
```

#### **æ¸¯è‚¡è§é¡¶æ£€æµ‹**
```python
from position_analysis.analyzers.risk_detection.hk_market_top_detector import HKMarketTopDetector

hk_top = HKMarketTopDetector()
hk_risk = hk_top.detect_top_risk()
print(f"æ¸¯è‚¡è§é¡¶é£é™©: {hk_risk['overall_risk']:.2f}")
```

### ğŸ“Š **é£é™©è¯„åˆ†è§£è¯»**:

| é£é™©è¯„åˆ† | é£é™©ç­‰çº§ | æ“ä½œå»ºè®® |
|---------|---------|---------|
| < 0.3 | ğŸŸ¢ ä½é£é™© | âœ… å®‰å…¨,å¯æŒæœ‰ |
| 0.3-0.5 | ğŸŸ¡ ä¸­é£é™© | âš ï¸ æ³¨æ„,è®¾æ­¢æŸ |
| 0.5-0.7 | ğŸŸ  é«˜é£é™© | ğŸ”´ å‡ä»“,ä¿ç•™æ ¸å¿ƒä»“ä½ |
| > 0.7 | ğŸ”´ æé«˜é£é™© | ğŸ”´ å¼ºçƒˆå»ºè®®å¤§å¹…å‡ä»“ |

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: Aè‚¡æ¶¨äº†ä¸€æ³¢,ç°åœ¨æ˜¯ä¸æ˜¯è¦è§é¡¶äº†?
æ“ä½œ: è¿è¡Œç‰›å¸‚é¡¶éƒ¨æ£€æµ‹
ç»“æœ:
  ç»¼åˆé£é™©è¯„åˆ†: 0.75
  é£é™©ç­‰çº§: æé«˜
  é£é™©å› ç´ :
    - ä¼°å€¼åˆ†ä½æ•°90% (å†å²é«˜ä½)
    - æ—¥å‡æˆäº¤é¢2.5ä¸‡äº¿ (æ˜¯å¹³æ—¶2å€)
    - æ¶¨åœæ•°è¿ç»­5æ—¥>150åª (æƒ…ç»ªç™«ç‹‚)
    - MACDé¡¶èƒŒç¦» (æŠ€æœ¯è§é¡¶)
    - åŒ—å‘èµ„é‡‘è½¬ä¸ºæµå‡º (èªæ˜é’±æ’¤é€€)

åˆ¤æ–­:
  ğŸ”´ 5é¡¹é£é™©å› ç´ å…¨éƒ¨æ»¡è¶³ â†’ ç‰›å¸‚é¡¶éƒ¨ç‰¹å¾æ˜æ˜¾
  â†’ å¼ºçƒˆå»ºè®®: å¤§å¹…å‡ä»“è‡³30%ä»¥ä¸‹,ä¿ç•™æ ¸å¿ƒèµ„äº§
```

---

## åœºæ™¯6: å†å²ç‚¹ä½å¯¹æ¯”

### ğŸ“Œ **ä½ æƒ³çŸ¥é“**:
- ç°åœ¨è¿™ä¸ªç‚¹ä½å†å²ä¸Šå‡ºç°è¿‡å—?
- å†å²ä¸Šè¿™ä¸ªç‚¹ä½åæ¥æ€ä¹ˆèµ°çš„?
- ä¸Šæ¶¨æ¦‚ç‡å¤šå°‘?å¹³å‡æ¶¨å¤šå°‘?

### ğŸ”§ **ä½¿ç”¨å·¥å…·**:

```python
from position_analysis.core.historical_position_analyzer import HistoricalPositionAnalyzer

analyzer = HistoricalPositionAnalyzer()

# åˆ†æä¸Šè¯æŒ‡æ•°
index_code = 'sh000001'
df = analyzer.get_index_data(index_code)
current_price = df['close'].iloc[-1]

# æŸ¥æ‰¾ç›¸ä¼¼ç‚¹ä½
similar = analyzer.find_similar_periods(index_code, current_price, tolerance=0.05)
print(f"å†å²ç›¸ä¼¼ç‚¹ä½: {len(similar)}ä¸ª")

# è®¡ç®—æœªæ¥æ”¶ç›Š
future_returns = analyzer.calculate_future_returns(index_code, similar, [5, 10, 20, 60])

# 20æ—¥åç»Ÿè®¡
ret_20d = future_returns['return_20d'].dropna()
up_count = (ret_20d > 0).sum()
total = len(ret_20d)
print(f"20æ—¥ä¸Šæ¶¨æ¦‚ç‡: {up_count/total:.1%} ({up_count}æ¬¡/{total}æ¬¡)")
print(f"å¹³å‡æ”¶ç›Š: {ret_20d.mean():.2%}")
print(f"ä¸­ä½æ•°æ”¶ç›Š: {ret_20d.median():.2%}")
```

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: ä¸Šè¯æŒ‡æ•°3850ç‚¹,å†å²ä¸Šè¿™ä¸ªä½ç½®åæ¥æ€ä¹ˆèµ°?
æ“ä½œ: è¿è¡Œå†å²ç‚¹ä½å¯¹æ¯”
ç»“æœ:
  å†å²ç›¸ä¼¼ç‚¹ä½: 127ä¸ª
  å¹´ä»½åˆ†å¸ƒ: 2007å¹´42æ¬¡, 2015å¹´41æ¬¡, 2025å¹´30æ¬¡

  20æ—¥å:
    ä¸Šæ¶¨æ¦‚ç‡: 51% (56æ¬¡/110æ¬¡)
    ä¸‹è·Œæ¦‚ç‡: 49% (54æ¬¡/110æ¬¡)
    å¹³å‡æ”¶ç›Š: +0.5%
    ä¸­ä½æ•°: +0.1%

åˆ¤æ–­:
  âš–ï¸ æ¶¨è·Œæ¦‚ç‡æ¥è¿‘ â†’ æ–¹å‘ä¸æ˜ç¡®
  ğŸ’¡ æ³¨æ„2007å’Œ2015éƒ½æ˜¯ç‰›å¸‚é«˜ç‚¹å¹´ä»½
  â†’ å»ºè®®: ä¸­æ€§è§‚æœ›,ä¸è¿½é«˜
```

---

## åœºæ™¯7: ç»¼åˆåˆ†æ (æ¨èâ­â­â­)

### ğŸ“Œ **ä½ æƒ³è¦**:
ä¸€æ¬¡æ€§çœ‹å®Œæ‰€æœ‰ç»´åº¦:
- å†å²æ¦‚ç‡
- æŠ€æœ¯é¢
- èµ„é‡‘é¢
- ä¼°å€¼
- æƒ…ç»ª
- é£é™©

### ğŸ”§ **æœ€ç®€å•çš„æ–¹æ³•**:

#### **Aè‚¡ç»¼åˆåˆ†æ**
```bash
# æ–¹å¼1: å‘½ä»¤è¡Œå¿«é€Ÿåˆ†æ
python position_analysis/main.py
# é€‰æ‹© 1 (Aè‚¡å¸‚åœº)

# æ–¹å¼2: Pythonè„šæœ¬
python -c "
from position_analysis.market_analyzers.cn_market_analyzer import CNMarketAnalyzer
analyzer = CNMarketAnalyzer()
result = analyzer.analyze_single_index('sh000001', tolerance=0.05)
print('å·²ç”Ÿæˆå®Œæ•´æŠ¥å‘Š')
"
```

#### **ç¾è‚¡ç»¼åˆåˆ†æ**
```bash
python scripts/us_stock_analysis/run_us_analysis.py
```

#### **æ¸¯è‚¡ç»¼åˆåˆ†æ**
```bash
python scripts/hk_stock_analysis/run_hk_analysis.py
```

### ğŸ“Š **æŠ¥å‘ŠåŒ…å«å†…å®¹**:

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          å®Œæ•´åˆ†ææŠ¥å‘Š (ç¤ºä¾‹)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€å½“å‰ç‚¹ä½ã€‘
  ä¸Šè¯æŒ‡æ•°: 3850.00
  æ—¥æœŸ: 2025-10-15

ã€å†å²ç‚¹ä½åˆ†æã€‘ â† åœºæ™¯6
  ç›¸ä¼¼ç‚¹ä½: 127ä¸ª
  20æ—¥ä¸Šæ¶¨æ¦‚ç‡: 51%
  å¹³å‡æ”¶ç›Š: +0.5%
  ç½®ä¿¡åº¦: 71%

ã€æŠ€æœ¯é¢åˆ†æã€‘ â† åœºæ™¯1
  MACD: é‡‘å‰
  RSI: 65 (åè¶…ä¹°ä½†æœªè¿‡çƒ­)
  KDJ: Kçº¿åœ¨70é™„è¿‘
  èƒŒç¦»: æ— æ˜æ˜¾èƒŒç¦»

ã€èµ„é‡‘é¢åˆ†æã€‘ â† åœºæ™¯2
  åŒ—å‘èµ„é‡‘: è¿‘5æ—¥å‡€æµå…¥150äº¿ âœ…
  èèµ„ä½™é¢: 1.78ä¸‡äº¿ (ç¨³å®š)
  ä¸»åŠ›èµ„é‡‘: å‡€æµå…¥

ã€ä¼°å€¼åˆ†æã€‘ â† åœºæ™¯3
  PEåˆ†ä½æ•°: 75% âš ï¸ åé«˜
  PBåˆ†ä½æ•°: 72% âš ï¸ åé«˜
  ä¼°å€¼æ°´å¹³: åˆç†åé«˜

ã€å¸‚åœºæƒ…ç»ªã€‘ â† åœºæ™¯4
  æ¶¨åœå®¶æ•°: 88åª
  å¸‚åœºçŠ¶æ€: æƒ…ç»ªè‰¯å¥½
  è¿‡çƒ­ç¨‹åº¦: ä¸­ç­‰

ã€é£é™©è¯„ä¼°ã€‘ â† åœºæ™¯5
  ç»¼åˆé£é™©: 0.45 (ä¸­é£é™©)
  è§é¡¶é£é™©: ä¸­ç­‰
  ä¸»è¦é£é™©: ä¼°å€¼åé«˜

ã€ç»¼åˆåˆ¤æ–­ã€‘
  æ–¹å‘: ä¸­æ€§åå¤š
  å»ºè®®ä»“ä½: 50-60%
  æ“ä½œç­–ç•¥:
    - ä¼°å€¼åé«˜,ä¸è¿½é«˜
    - èµ„é‡‘é¢æ”¯æŒ,å¯æŒæœ‰
    - æŠ€æœ¯é¢å¥åº·,è®¾å¥½æ­¢æŸ
    - ç­‰å›è°ƒ3-5%ååŠ ä»“
```

### ğŸ¯ **å®æˆ˜æ¡ˆä¾‹**:
```
é—®é¢˜: æˆ‘æƒ³å…¨é¢äº†è§£ç°åœ¨Aè‚¡èƒ½ä¸èƒ½ä¹°?
æ“ä½œ: è¿è¡Œç»¼åˆåˆ†æ
æ—¶é—´: 3åˆ†é’Ÿ
ç»“æœ: ä¸€ä»½å®Œæ•´æŠ¥å‘Š,åŒ…å«ä¸Šé¢æ‰€æœ‰7ä¸ªç»´åº¦

åˆ¤æ–­æµç¨‹:
  1. å…ˆçœ‹é£é™©è¯„ä¼° â†’ ä¸­é£é™©,å¯æ§
  2. å†çœ‹ä¼°å€¼ â†’ åé«˜,ä¸æ˜¯æœ€ä½³ä¹°ç‚¹
  3. çœ‹èµ„é‡‘é¢ â†’ åŒ—å‘æµå…¥,æ”¯æŒ
  4. çœ‹æŠ€æœ¯é¢ â†’ å¥åº·,æ— èƒŒç¦»
  5. çœ‹æƒ…ç»ª â†’ è‰¯å¥½,æœªè¿‡çƒ­
  6. çœ‹å†å²æ¦‚ç‡ â†’ ä¸­æ€§,æ¶¨è·Œæ¦‚ç‡ç›¸å½“

æœ€ç»ˆå†³ç­–:
  âš–ï¸ ç»¼åˆåˆ¤æ–­: å¯ä»¥è½»ä»“å‚ä¸(30-40%)
  ğŸ’¡ æœ€ä½³ç­–ç•¥: ç­‰å¾…å›è°ƒ3-5%ååŠ ä»“è‡³50-60%
  ğŸ¯ æ­¢æŸä½: 3700ç‚¹
```

---

## ğŸ“ è¿›é˜¶ç»„åˆç­–ç•¥

### ç­–ç•¥1: ç‰›å¸‚ç¡®è®¤ç»„åˆ
```
1. å†å²æ¦‚ç‡ > 60% ä¸Šæ¶¨ âœ…
2. ä¼°å€¼ < 60åˆ†ä½ âœ…
3. åŒ—å‘èµ„é‡‘è¿ç»­æµå…¥ âœ…
4. MACDé‡‘å‰ âœ…
5. é£é™©è¯„åˆ† < 0.4 âœ…

â†’ 5é¡¹å…¨æ»¡è¶³ â†’ ç¡®è®¤ç‰›å¸‚,å¯é‡ä»“(70-80%)
```

### ç­–ç•¥2: ç†Šå¸‚ç¡®è®¤ç»„åˆ
```
1. å†å²æ¦‚ç‡ < 40% ä¸Šæ¶¨ ğŸ”´
2. ä¼°å€¼ > 80åˆ†ä½ ğŸ”´
3. åŒ—å‘èµ„é‡‘æŒç»­æµå‡º ğŸ”´
4. MACDæ­»å‰æˆ–é¡¶èƒŒç¦» ğŸ”´
5. é£é™©è¯„åˆ† > 0.6 ğŸ”´

â†’ æ»¡è¶³3é¡¹ä»¥ä¸Š â†’ ç†Šå¸‚ç‰¹å¾,å»ºè®®å‡ä»“è‡³20-30%
```

### ç­–ç•¥3: æŠ„åº•ç»„åˆ
```
1. ä¼°å€¼ < 30åˆ†ä½ âœ… (ä¾¿å®œ)
2. å¸‚åœºæƒ…ç»ªä½è¿·(æ¶¨åœ<20åª) âœ… (ææ…Œ)
3. RSI < 30 âœ… (è¶…å–)
4. åŒ—å‘èµ„é‡‘å¼€å§‹æµå…¥ âœ… (èªæ˜é’±è¿›åœº)

â†’ æ»¡è¶³3é¡¹ â†’ å¯èƒ½æ˜¯åº•éƒ¨,å¯åˆ†æ‰¹å»ºä»“
```

### ç­–ç•¥4: é€ƒé¡¶ç»„åˆ
```
1. ä¼°å€¼ > 85åˆ†ä½ ğŸ”´
2. æ¶¨åœæ•° > 150åªè¿ç»­3å¤© ğŸ”´
3. MACDé¡¶èƒŒç¦» ğŸ”´
4. æˆäº¤é¢æš´å¢(>å¹³æ—¶2å€) ğŸ”´
5. åŒ—å‘èµ„é‡‘è½¬ä¸ºæµå‡º ğŸ”´
6. é£é™©è¯„åˆ† > 0.7 ğŸ”´

â†’ æ»¡è¶³4é¡¹ä»¥ä¸Š â†’ ç‰›å¸‚é¡¶éƒ¨,å¼ºçƒˆå»ºè®®å‡ä»“
```

---

## ğŸ“± å¿«é€ŸæŸ¥è¯¢è¡¨

| æˆ‘æƒ³... | ç”¨ä»€ä¹ˆå·¥å…· | æŸ¥ä»€ä¹ˆæŒ‡æ ‡ | å¤šä¹…æ›´æ–° |
|--------|-----------|-----------|---------|
| çœ‹MACD | èƒŒç¦»åˆ†æå™¨ | MACDé‡‘å‰/æ­»å‰/èƒŒç¦» | æ¯æ—¥ |
| çœ‹åŒ—å‘èµ„é‡‘ | CNæŒ‡æ ‡åˆ†æå™¨ | æµå…¥/æµå‡º/è¶‹åŠ¿ | æ¯æ—¥ |
| çœ‹ä¼°å€¼ | ä¼°å€¼åˆ†æå™¨ | PE/PBåˆ†ä½æ•° | æ¯æ—¥ |
| çœ‹æƒ…ç»ª | CNæŒ‡æ ‡åˆ†æå™¨ | æ¶¨åœæ•°/æ–°é«˜æ•° | æ¯æ—¥ |
| çœ‹é£é™© | é£é™©æ£€æµ‹å™¨ | ç»¼åˆé£é™©è¯„åˆ† | æ¯æ—¥ |
| çœ‹å†å² | å†å²ç‚¹ä½åˆ†æå™¨ | æœªæ¥æ¦‚ç‡ç»Ÿè®¡ | å®æ—¶ |
| çœ‹å…¨éƒ¨ | å¸‚åœºç»¼åˆåˆ†æå™¨ | å®Œæ•´æŠ¥å‘Š | æ¯æ—¥ |

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### 1ï¸âƒ£ **æ—¥å¸¸ä½¿ç”¨æµç¨‹**
```
æ—©ä¸Š: è¿è¡Œç»¼åˆåˆ†æ â†’ æŸ¥çœ‹æ•´ä½“çŠ¶å†µ
é‡ç‚¹çœ‹:
  - é£é™©è¯„åˆ†(æ˜¯å¦>0.6)
  - åŒ—å‘èµ„é‡‘(æ˜¯å¦æµå‡º)
  - ä¼°å€¼åˆ†ä½æ•°(æ˜¯å¦>85%)

å‘ç°å¼‚å¸¸ â†’ æ·±å…¥åˆ†æå¯¹åº”ç»´åº¦
```

### 2ï¸âƒ£ **ä¹°å…¥å†³ç­–æµç¨‹**
```
1. å…ˆçœ‹é£é™©è¯„åˆ† â†’ å¦‚æœ>0.6,æ”¾å¼ƒ
2. å†çœ‹ä¼°å€¼ â†’ å¦‚æœ>80%,ç­‰å›è°ƒ
3. çœ‹èµ„é‡‘é¢ â†’ åŒ—å‘æµå…¥æ‰è€ƒè™‘
4. çœ‹æŠ€æœ¯é¢ â†’ æ— èƒŒç¦»æ‰å®‰å…¨
5. çœ‹å†å²æ¦‚ç‡ â†’ å‚è€ƒé¢„æœŸæ”¶ç›Š

â†’ éƒ½æ»¡è¶³ â†’ å¯ä»¥ä¹°å…¥
```

### 3ï¸âƒ£ **å–å‡ºå†³ç­–æµç¨‹**
```
1. å…ˆçœ‹é£é™©è¯„åˆ† â†’ å¦‚æœ>0.7,ç«‹å³å‡ä»“
2. çœ‹æŠ€æœ¯èƒŒç¦» â†’ é¡¶èƒŒç¦»å‡ºç°,å‡ä»“
3. çœ‹èµ„é‡‘é¢ â†’ åŒ—å‘è¿ç»­æµå‡º,å‡ä»“
4. çœ‹æƒ…ç»ª â†’ æ¶¨åœ>150åªè¿ç»­3å¤©,å‡ä»“

â†’ æ»¡è¶³ä»»ä¸€æ¡ â†’ è€ƒè™‘å‡ä»“
â†’ æ»¡è¶³2æ¡ä»¥ä¸Š â†’ å¼ºçƒˆå»ºè®®å‡ä»“
```

---

**Made with â¤ï¸ by Claude Code & Russ**
