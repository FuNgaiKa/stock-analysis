# 聚宽平台A股市场火热程度量化模型使用指南

## 1. 聚宽平台特性适配

### 1.1 平台优势
- **数据源丰富**: 聚宽提供完整的A股历史和实时数据
- **计算资源**: 云端计算环境，无需本地部署
- **策略框架**: 完整的量化策略开发框架
- **回测能力**: 支持历史数据回测验证模型效果

### 1.2 API适配说明
本模型针对聚宽平台的特性进行了以下适配：
- 使用 `get_price()` 获取价格数据
- 使用 `get_current_data()` 获取实时行情
- 使用 `get_all_securities()` 获取股票列表
- 使用聚宽的定时任务框架 `run_daily()`

## 2. 部署和配置

### 2.1 在聚宽平台中创建策略

1. 登录聚宽平台 (www.joinquant.com)
2. 进入"我的策略"
3. 点击"新建策略"
4. 将代码复制到策略编辑器中
5. 设置策略参数

### 2.2 重要参数配置

```python
# 关键参数说明
g.weights = {
    'volume_ratio': 0.25,      # 可根据历史表现调整
    'price_momentum': 0.20,    
    'market_breadth': 0.20,    
    'volatility': 0.15,        
    'sentiment': 0.20          
}

g.lookback_days = 20          # 历史数据窗口，建议10-30天
g.heat_threshold = 0.6        # 高风险阈值，可根据风险偏好调整
```

### 2.3 运行时间设置
```python
run_daily(analyze_market_heat, time='09:30')  # 开盘后分析
run_daily(analyze_market_heat, time='11:00')  # 上午收盘前  
run_daily(analyze_market_heat, time='14:00')  # 下午开盘后
run_daily(analyze_market_heat, time='14:50')  # 收盘前
```

## 3. 核心功能模块

### 3.1 数据获取模块
**功能**: 获取多维度市场数据
- 主要指数行情数据 
- 全市场股票统计
- 涨跌停股票统计
- 北向资金流入数据

**容错机制**:
- 分批获取避免超时
- 异常数据使用默认值
- 网络异常时跳过分析

### 3.2 指标计算模块

#### 成交量比率 (25% 权重)
```python
volume_ratio = 当日成交额 / 历史平均成交额
```
- **阈值**: 2倍成交量为满分
- **含义**: 衡量市场参与热度

#### 价格动量 (20% 权重)  
```python
momentum = 加权指数涨跌幅 (上证40% + 沪深300/30% + 创业板30%)
```
- **处理**: tanh函数平滑化
- **含义**: 反映市场整体趋势强度

#### 市场广度 (20% 权重)
```python
breadth = 涨跌股票比例 + 涨跌停调整项
```
- **优势**: 防止权重股拉抬指数误导
- **含义**: 评估市场参与广度

#### 波动率 (15% 权重)
```python
volatility = 年化收益率标准差  
```
- **计算**: 基于20日滚动数据
- **含义**: 衡量市场不确定性

#### 情绪指标 (20% 权重)
```python
sentiment = 涨跌停比例 + 北向资金修正
```
- **创新点**: 结合外资情绪修正
- **含义**: 捕捉极端市场情绪

### 3.3 风险评估模块

#### 评分体系
| 评分区间 | 风险等级 | 仓位建议 | 市场状态 |
|---------|----------|----------|----------|
| 0.8-1.0 | 极高风险 | 3-4成仓位 | 疯牛末期 |
| 0.6-0.8 | 高风险 | 5-6成仓位 | 情绪过热 |
| 0.4-0.6 | 中等风险 | 6-7成仓位 | 正常牛市 |
| 0.2-0.4 | 低风险 | 7-8成仓位 | 温和上涨 |
| 0.0-0.2 | 极低风险 | 可满仓